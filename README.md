# redux-unfold-saga

![npm](https://img.shields.io/npm/v/redux-unfold-saga.svg)
![npm](https://img.shields.io/npm/dw/redux-unfold-sage.svg)
![NPM](https://img.shields.io/npm/l/redux-unfold-saga.svg)
[![Build Status](https://travis-ci.org/manhhailua/redux-unfold-saga.svg?branch=master)](https://travis-ci.org/manhhailua/redux-unfold-saga)
[![codecov](https://codecov.io/gh/manhhailua/redux-unfold-saga/branch/master/graph/badge.svg)](https://codecov.io/gh/manhhailua/redux-unfold-saga)
[![semantic-release](https://img.shields.io/badge/%20%20%F0%9F%93%A6%F0%9F%9A%80-semantic--release-e10079.svg)](https://github.com/semantic-release/semantic-release)
![Snyk Vulnerabilities for npm package](https://img.shields.io/snyk/vulnerabilities/npm/redux-unfold-saga.svg)

A no headache middleware helper for redux-saga.

## Getting started

#### Install

```bash
npm install --save redux-unfold-saga
```

or

```bash
yarn add redux-unfold-saga
```

#### Example repo

If you want a quick demo repo in real life.

-   <https://github.com/manhhailua/redux-unfold-saga-example>

#### Usage example

-   index.js

```javascript
import React from 'react';
import { createAction } from 'redux-unfold-saga';

const queryPosts = createAction('QUERY_POSTS');

export default class PostList extends React.Component {
  state = {
    isLoading: false,
    posts: [],
  };

  componentDidMount() {
    this.dispatchQueryPosts();
  }

  dispatchQueryPosts = () => {
    this.props.dispatch(
      queryPosts(
        {
          type: 'HOT',
        },
        {
          onBeginning: () => {
            // Do something before the query
            this.setState({ isLoading: true });
          },
          onFailure: error => {
            // Do something in case of caught error
          },
          onSuccess: posts => {
            // Do something after the query succeeded
            this.setState({ posts });
          },
          onFinished: () => {
            // Do something after everything is done
            this.setState({ isLoading: false });
          },
        },
      ),
    );
  };

  render() {
    return (
      <View>
        {this.state.isLoading && <Text>Loading...</Text>}
        {this.state.posts.map(post => (
          <Text>{post.title}</Text>
        ))}
      </View>
    );
  }
}
```

-   saga.js

```javascript
import { unfoldSaga } from 'redux-unfold-saga';

function* takeQueryPosts({ payload }) {
  yield unfoldSaga({
    handler: async () => {
      const posts = await queryPosts(payload);
      return posts;
    },
    key: 'QUERY_POSTS',
  });
}

function* defaultSaga() {
  yield takeLatest('QUERY_POSTS', takeQueryPosts);
}
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [createActionTypeOnBeginning](#createactiontypeonbeginning)
    -   [Parameters](#parameters)
    -   [Examples](#examples)
-   [createActionTypeOnFailure](#createactiontypeonfailure)
    -   [Parameters](#parameters-1)
    -   [Examples](#examples-1)
-   [createActionTypeOnFinish](#createactiontypeonfinish)
    -   [Parameters](#parameters-2)
    -   [Examples](#examples-2)
-   [createActionTypeOnSuccess](#createactiontypeonsuccess)
    -   [Parameters](#parameters-3)
    -   [Examples](#examples-3)
-   [createAction](#createaction)
    -   [Parameters](#parameters-4)
    -   [Examples](#examples-4)
-   [unfoldSaga](#unfoldsaga)
    -   [Parameters](#parameters-5)
    -   [Examples](#examples-5)

### createActionTypeOnBeginning

Create onBeginning action type

#### Parameters

-   `key` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

#### Examples

```javascript
createActionTypeOnSuccess('DO_SOMETHING') // 'DO_SOMETHING_BEGAN'
```

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

### createActionTypeOnFailure

Create onFailure action type

#### Parameters

-   `key` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

#### Examples

```javascript
createActionTypeOnSuccess('DO_SOMETHING') // 'DO_SOMETHING_FAILED'
```

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

### createActionTypeOnFinish

Create onFinish action type

#### Parameters

-   `key` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

#### Examples

```javascript
createActionTypeOnSuccess('DO_SOMETHING') // 'DO_SOMETHING_FINISHED'
```

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

### createActionTypeOnSuccess

Create onSuccess action type

#### Parameters

-   `key` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

#### Examples

```javascript
createActionTypeOnSuccess('DO_SOMETHING') // 'DO_SOMETHING_SUCCEEDED'
```

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

### createAction

Create an action for real life usage inside or even outside of a component

#### Parameters

-   `type` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

#### Examples

Inside of a component


```javascript
const queryPosts = createAction('QUERY_POSTS');

this.props.dispatch(
  queryPosts(
    {
      category: 'HOT',
    },
    {
      onBeginning: () => {
        // Do something before the query
        this.setState({ isLoading: true });
      }
      onFailure: (error) => {
        // Do something in case of caught error
      }
      onSuccess: (posts) => {
        // Do something after the query succeeded
      }
      onFinished: () => {
        // Do something after everything is done
        this.setState({ isLoading: false });
      }
    },
  ),
);
```

Outside of a react component


```javascript
store.dispatch(
  queryPosts({
    type: 'HOT',
  }),
);
```

Inside another saga


```javascript
const queryPosts = createAction('QUERY_POSTS');

function* takeQueryPosts() {
  yield put(queryPosts());
}
```

Returns **UnfoldSagaActionType** 

### unfoldSaga

Common saga helper that unifies handling side effects into only one standard form

#### Parameters

-   `body` **UnfoldSagaHandlerType** 
    -   `body.handler` **[Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)** Main handler function. Its returned value will become onSuccess callback param
    -   `body.key` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Action type
-   `callbacks` **UnfoldSagaCallbacksType**  (optional, default `{}`)
    -   `callbacks.onBeginning` **[Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)** This callback will be called after onBeginning action is dispatched. (optional, default `noop`)
    -   `callbacks.onFailure` **[Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)** This callback will be called after onFailure action is dispatched. It will only be called in case of error. (optional, default `noop`)
    -   `callbacks.onFinish` **[Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)** This callback will be called after onFinish action is dispatched. (optional, default `noop`)
    -   `callbacks.onSuccess` **[Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)** This callback will be called after onSuccess action is dispatched. It will not be called in case of error. (optional, default `noop`)

#### Examples

```javascript
function* takeQueryPosts({ payload: { category } }) {
  yield unfoldSaga({
    handler: async () => {
      const posts = await queryPosts({ category });
      return posts;
    },
    key: 'QUERY_POSTS',
  });
}

function* defaultSaga() {
  yield takeLatest('QUERY_POSTS', takeQueryPosts);
}
```

Returns **Saga&lt;void>** 

## License

MIT Â© [Manh Pham](https://github.com/manhhailua) - [manhpt.com](https://manhpt.com)
